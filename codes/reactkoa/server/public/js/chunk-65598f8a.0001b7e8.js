(window["webpackJsonpdocs"]=window["webpackJsonpdocs"]||[]).push([["chunk-65598f8a"],{"0c89":function(t,e,n){"use strict";n("528c")},"365c":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return c})),n.d(e,"f",(function(){return u}));var a=n("b775");function i(t){return Object(a["a"])({url:"official/iportal/media/news/record",params:t,method:"GET"})}function o(t){return Object(a["a"])({url:"official/iportal/media/news/change",data:t,method:"POST"})}function r(t){return Object(a["a"])({url:"official/iportal/media/news/preview",data:t,method:"POST"})}function s(t){return Object(a["a"])({url:"official/iportal/media/news/save",data:t,method:"POST"})}function l(t){return Object(a["a"])({url:"official/iportal/media/news/edit/"+t,method:"get"})}function c(t){return Object(a["a"])({url:"official/iportal/media/news/del/"+t,method:"get"})}function u(t){return Object(a["a"])({url:"official/iportal/top",data:t,method:"POST"})}},"528c":function(t,e,n){},"66bd":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"layout-base"},[n("layout-base",{attrs:{title:t.title,crumbs:t.crumbs}},[n("div",[n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"form-title",attrs:{slot:"title"},slot:"title"},[n("a-button",{staticStyle:{float:"left"},on:{click:function(e){return t.$router.push("/docs/jtips/list/"+t.lang)}}},[t._v(" 返回 ")]),t.isEdit?n("a-button",{staticStyle:{float:"right"},attrs:{type:"danger"},on:{click:t.handleDelete}},[t._v(" 删除 ")]):t._e(),n("a-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.handlePutIt}},[t._v(" 发布 ")]),n("a-button",{staticStyle:{float:"right"},attrs:{ghost:"",type:"primary",loading:t.previewLoading},on:{click:t.handlePreview}},[t._v(" 预览 ")]),n("a-button",{staticStyle:{float:"right"},attrs:{loading:t.saveLoading},on:{click:t.handleSave}},[t._v(" 保存 ")])],1),n("div",{staticClass:"steps-wrapper"},[n("a-steps",{attrs:{current:t.stepsData.current},on:{change:t.onStepsChange}},t._l(t.stepsData.steps,(function(t){return n("a-step",{key:t.title,attrs:{title:t.title}})})),1)],1),n("div",{staticClass:"steps-content"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"edit-content"===t.stepsData.steps[t.stepsData.current].content,expression:"stepsData.steps[stepsData.current].content === 'edit-content'"}],staticClass:"content-box edit-content"},[n("a-form",{staticClass:"form",attrs:{"label-col":{span:5},"wrapper-col":{span:15}}},[n("a-form-item",{attrs:{label:"文章标题","validate-status":t.$validate.title?"error":"",help:t.$validate.title}},[n("a-input",{attrs:{placeholder:"必填，请输入文章标题"},on:{change:function(e){return t.initValidate("title")}},model:{value:t.viewInfo.title,callback:function(e){t.$set(t.viewInfo,"title",e)},expression:"viewInfo.title"}})],1),n("a-form-item",{attrs:{label:"发布站点"}},[n("a-input",{attrs:{placeholder:"非必填，该文章的发布站点名称"},model:{value:t.viewInfo.psite,callback:function(e){t.$set(t.viewInfo,"psite",e)},expression:"viewInfo.psite"}})],1),n("a-form-item",{attrs:{label:"摘要","validate-status":t.$validate.remark?"error":"",help:t.$validate.remark}},[n("a-input",{attrs:{type:"textarea",placeholder:"必填，请输入文章摘要"},on:{change:function(e){return t.initValidate("remark")}},model:{value:t.viewInfo.remark,callback:function(e){t.$set(t.viewInfo,"remark",e)},expression:"viewInfo.remark"}})],1),n("a-form-item",{attrs:{label:"选择图片"}},[n("ImgUpload",{staticClass:"set-style",staticStyle:{height:"132px"},attrs:{"default-url":t.viewInfo.posterUrl,tip:"图片尺寸：728*400，支持png、jpg、gif"},on:{change:t.handleUploadChange}})],1),n("a-form-item",{attrs:{label:"发布时间"}},[n("a-date-picker",{model:{value:t.viewInfo.ptime,callback:function(e){t.$set(t.viewInfo,"ptime",e)},expression:"viewInfo.ptime"}})],1),n("a-form-item",{attrs:{label:"站点"}},[n("a-radio-group",{attrs:{"button-style":"solid"},model:{value:t.viewInfo.isJgLink,callback:function(e){t.$set(t.viewInfo,"isJgLink",e)},expression:"viewInfo.isJgLink"}},[n("a-radio-button",{attrs:{value:1}},[t._v(" 极光本站 ")]),n("a-radio-button",{attrs:{value:0}},[t._v(" 外部链接 ")])],1)],1),n("a-form-item",{directives:[{name:"show",rawName:"v-show",value:t.viewInfo.isJgLink,expression:"viewInfo.isJgLink"}],staticStyle:{"z-index":"1"},attrs:{label:"内容"}},[n("div",{attrs:{id:"tipsEditor"}})]),n("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.viewInfo.isJgLink,expression:"!viewInfo.isJgLink"}],attrs:{label:"外链地址","validate-status":t.$validate.externalUrl?"error":"",help:t.$validate.externalUrl}},[n("a-input",{attrs:{placeholder:"必填，请输入外链地址"},on:{change:function(e){return t.initValidate("externalUrl")}},model:{value:t.viewInfo.externalUrl,callback:function(e){t.$set(t.viewInfo,"externalUrl",e)},expression:"viewInfo.externalUrl"}})],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"seo-content"===t.stepsData.steps[t.stepsData.current].content,expression:"stepsData.steps[stepsData.current].content === 'seo-content'"}],staticClass:"content-box seo-content"},[n("a-form",{staticClass:"form",attrs:{"label-col":{span:5},"wrapper-col":{span:15}}},[n("a-form-item",{attrs:{label:"标题","validate-status":t.$seoValidate.title?"error":"",help:t.$seoValidate.title}},[n("a-input",{attrs:{maxLength:"en"===t.lang?80:40,placeholder:"必填，用于搜索引擎优化"},on:{change:function(e){return t.initSeoValidate("title")}},model:{value:t.seoInfo.title,callback:function(e){t.$set(t.seoInfo,"title",e)},expression:"seoInfo.title"}}),n("inputLmitTip",{attrs:{limit:"en"===t.lang?80:40,text:t.seoInfo.title}})],1),n("a-form-item",{attrs:{label:"关键字","validate-status":t.$seoValidate.keyword?"error":"",help:t.$seoValidate.keyword}},[n("a-input",{attrs:{maxLength:"en"===t.lang?80:40,placeholder:"必填，用于搜索引擎优化"},on:{change:function(e){return t.initSeoValidate("keyword")}},model:{value:t.seoInfo.keyword,callback:function(e){t.$set(t.seoInfo,"keyword",e)},expression:"seoInfo.keyword"}}),n("inputLmitTip",{attrs:{limit:"en"===t.lang?80:40,text:t.seoInfo.keyword}})],1),n("a-form-item",{attrs:{label:"描述","validate-status":t.$seoValidate.description?"error":"",help:t.$seoValidate.description}},[n("a-input",{attrs:{maxLength:"en"===t.lang?150:75,placeholder:"必填，用于搜索引擎优化"},on:{change:function(e){return t.initSeoValidate("description")}},model:{value:t.seoInfo.description,callback:function(e){t.$set(t.seoInfo,"description",e)},expression:"seoInfo.description"}}),n("inputLmitTip",{attrs:{limit:"en"===t.lang?150:75,text:t.seoInfo.description}})],1)],1)],1)]),n("a-row",{staticClass:"steps-action"},[n("a-col",{attrs:{offset:5}},[n("a-button",{directives:[{name:"show",rawName:"v-show",value:t.stepsData.current<t.stepsData.steps.length-1,expression:"stepsData.current < stepsData.steps.length - 1"}],attrs:{type:"primary"},on:{click:t.next}},[t._v(" 下一步 ")]),n("a-button",{directives:[{name:"show",rawName:"v-show",value:t.stepsData.current>0,expression:"stepsData.current > 0"}],on:{click:t.prev}},[t._v(" 上一步 ")]),n("a-button",{directives:[{name:"show",rawName:"v-show",value:t.stepsData.current===t.stepsData.steps.length-1,expression:"stepsData.current === stepsData.steps.length - 1"}],staticStyle:{"margin-left":"12px"},attrs:{type:"primary"},on:{click:t.handlePutIt}},[t._v(" 发布 ")])],1)],1)],1)],1)])],1)},i=[],o=n("5530"),r=(n("a4d3"),n("e01a"),n("a9e3"),n("d3b7"),n("159b"),n("b64b"),n("1d61")),s=n("750b"),l=n("d4ec"),c=n("bee2"),u=n("262e"),d=n("2caf"),p=(n("ac1f"),n("5319"),n("5f87")),f=n("6fad"),m=n.n(f),v=function(t){var e=Object(s["e"])({title:!1,remark:!1,externalUrl:!1}),n=Object(s["e"])({title:Object(s["a"])({get:function(){return e.title?t.title?"":"文章标题不能为空":""}}),remark:Object(s["a"])({get:function(){return e.remark?t.remark?"":"文章摘要不能为空":""}}),externalUrl:Object(s["a"])({get:function(){return t.isJgLink||!e.externalUrl||t.externalUrl?"":"外部连接不能为空"}})});function a(t){e[t]=!0}return{$validate:n,initValidate:a}},g=function(t){var e=Object(s["e"])({title:!1,keyword:!1,description:!1}),n=Object(s["e"])({title:Object(s["a"])({get:function(){return e.title?t.title?"":"标题不能为空":""}}),keyword:Object(s["a"])({get:function(){return e.keyword?t.keyword?"":"关键字不能为空":""}}),description:Object(s["a"])({get:function(){return e.description?t.description?"":"描述不能为空":""}})});function a(t){e[t]=!0}return{$seoValidate:n,initSeoValidate:a}},h=function(t){Object(u["a"])(n,t);var e=Object(d["a"])(n);function n(t){Object(l["a"])(this,n);var a=m.a.$('<div class="w-e-menu">\n        <span title="编辑源码">源码</span>\n      </div>');return e.call(this,a,t)}return Object(c["a"])(n,[{key:"clickHandler",value:function(){this.toggleActive(),this.toggleHtmlCode()}},{key:"toggleActive",value:function(){console.log(this.editor),this.isActive?this.unActive():this.active()}},{key:"toggleHtmlCode",value:function(){var t=this.editor.txt.html();t=this.isActive?t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;"):t.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&nbsp;/gi," "),this.editor.txt.html(t)}},{key:"tryChangeActive",value:function(){}}]),n}(m.a.BtnMenu),b=function(t){var e=new m.a(t),n=Object(p["a"])();return e.config.menuFixed=!1,e.config.uploadImgServer="http://devsvc-manual-api.glqa.jpushoa.com//iportal-official/picture",e.config.uploadImgAccept=["jpg","jpeg","png","gif","bmp"],e.config.uploadImgFileName="file",e.menus.extend("source",h),e.config.uploadImgHeaders={Accept:"application/json, text/plain, */*",Authorization:"sessionId="+n},e.config.uploadFileName="file",e.config.menus=["source","head","bold","fontSize","fontName","italic","underline","strikeThrough","indent","lineHeight","foreColor","emoticon","backColor","link","list","justify","quote","image","table","code","splitLine","undo"],e.config.uploadImgHooks={customInsert:function(t,e){console.log("customInsert",e),t(e.url)}},console.log(e.config),e.create(),e},w=n("4e72"),k=n("c32d"),I=n.n(k),y=n("365c"),j=n("d549"),O=n("80d4"),x={components:{LayoutBase:r["e"],ImgUpload:j["a"],inputLmitTip:O["a"]},name:"tips-edit",setup:function(t,e){var n,a=e.root,i=Object(p["a"])(),r=Object(s["f"])(!!a.$route.params.id),l=Object(s["e"])({content:"",externalUrl:"",isJgLink:1,keyword:"",picUrl:"",posterUrl:"",psite:"",ptime:I()(),remark:"",title:""}),c=Object(s["e"])({title:"",keyword:"",description:""}),u=Object(s["e"])({current:0,steps:[{title:"编辑内容",content:"edit-content"},{title:"seo设置",content:"seo-content"}]}),d=Object(s["e"])({lang:"zh",title:r.value?"编辑极光小知识":"创建极光小知识",isSaved:r.value,id:a.$route.params.id,crumbs:[{path:"",value:"官网管理"},{path:"/docs/jtips/list",value:"极光小知识"},{path:"",value:"中文"},{path:"",value:r.value?"编辑极光小知识":"创建极光小知识"}],originInfo:{},uploadLoading:!1,saveLoading:!1,previewLoading:!1,uploadHeaders:{Authorization:"sessionId="+i}});function f(t){l.posterUrl=t}Object(s["h"])((function(){return a.$route}),(function(t){d.lang="zh"===t.params.lang?"zh":"en",d.crumbs[1].path=d.crumbs[1].path+"/"+d.lang,"zh"===d.lang?d.crumbs[2].value="中文":d.crumbs[2].value="英文"}));var m=v(l),h=m.$validate,k=m.initValidate,j=g(c),O=j.$seoValidate,x=j.initSeoValidate;function L(){var t=Object(o["a"])(Object(o["a"])({},l),{},{seoTitle:c.title,seoKeyWords:c.keyword,seoDescription:c.description,isJgLink:!!l.isJgLink,ptime:l.ptime.format("YYYY-MM-DD"),mediaType:"KNOWLEDGE"});return d.id&&"null"!==d.id&&(t.id=Number(d.id)),t.languageType="zh"===d.lang?"CHINESE":"ENGLISH",t}function $(){var t=!1;return l.content=n?n.txt.html():"",k("title"),k("remark"),k("externalUrl"),Object.keys(h).forEach((function(e){h[e]&&(t=!0)})),t?(u.current=0,!1):!(l.isJgLink&&!l.content)||(w["message"].error("新闻内容不能为空"),!1)}function S(){var t=!1;return x("title"),x("keyword"),x("description"),Object.keys(O).forEach((function(e){O[e]&&(t=!0)})),!t||(u.current=1,!1)}function D(t){for(var e=Object.keys(t),n=0;n<e.length;n++)if(t[e[n]]!==d.originInfo[e[n]])return!0;return!1}function U(){if($()&&S()){d.saveLoading=!0;var t=L();Object(y["e"])(t).then((function(e){2e3===e.code&&e.message&&(d.id=e.message,d.originInfo=t,d.originInfo.id=Number(d.id),d.isSaved=!0,w["message"].success("保存成功"))})).finally((function(){d.saveLoading=!1}))}}function C(){if($()&&S()){var t=L();if(!d.isSaved||D(t))return void w["Modal"].error({title:"提示",content:"请先保存后预览或发布~"});d.previewLoading=!0,Object(y["d"])(t).then((function(t){2e3==t.code&&t.message&&window.open(t.message)})).finally((function(){d.previewLoading=!1}))}}function V(){if($()&&S()){var t=L();if(!d.isSaved||D(t))return void w["Modal"].error({title:"提示",content:"请先保存后预览或发布~"});w["Modal"].confirm({title:"提示",content:"确认发布该文章？",onOk:function(){return Object(y["g"])({pstatus:1,id:d.id}).then((function(){w["message"].success("发布成功"),a.$router.push("/docs/jtips/list/"+d.lang)}))}})}}function N(){w["Modal"].confirm({title:"确认要删除这条信息吗？",content:"您确认要删除这条信息吗，删除后不可恢复",onOk:function(){return Object(y["a"])(d.id).then((function(){w["message"].success("删除成功"),a.$router.go(-1)}))}})}function E(){$()&&u.current++}function T(){u.current--}function J(t){$()&&(u.current=t)}return Object(s["d"])((function(){n=b("#tipsEditor"),r.value&&Object(y["b"])(d.id).then((function(t){var e;l.content=t.content,l.title=t.title,l.remark=t.remark,l.posterUrl=t.posterUrl||"",l.keyword=t.keyword||"",l.picUrl=t.picUrl||"",l.psite=t.psite||"",l.isJgLink=t.isJgLink?1:0,l.ptime=I()(t.ptime),l.externalUrl=t.externalUrl||"",c.title=t.seoTitle||"",c.keyword=t.seoKeyWords||"",c.description=t.seoDescription||"",d.lang="ENGLISH"===t.languageType?"en":"zh",d.originInfo=t,d.originInfo.mediaType="KNOWLEDGE",d.originInfo.ptime=I()(t.ptime).format("YYYY-MM-DD"),d.originInfo.id=Number(d.id),d.originInfo.languageType=(null!==(e=t.languageType)&&void 0!==e?e:"zh"===d.lang)?"CHINESE":"ENGLISH",n.txt.html(t.content)}))})),Object(s["c"])((function(){n&&n.destroy(),n=null})),Object(o["a"])(Object(o["a"])({},Object(s["g"])(d)),{},{isEdit:r,viewInfo:l,$validate:h,initValidate:k,seoInfo:c,$seoValidate:O,initSeoValidate:x,handleUploadChange:f,handlePreview:C,handleSave:U,handlePutIt:V,handleDelete:N,stepsData:u,prev:T,next:E,onStepsChange:J})}},L=x,$=(n("0c89"),n("2877")),S=Object($["a"])(L,a,i,!1,null,"286d8486",null);e["default"]=S.exports}}]);
//# sourceMappingURL=chunk-65598f8a.0001b7e8.js.map